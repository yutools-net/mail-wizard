<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YUTOOLS|Mail Wizard - é«˜æ©Ÿèƒ½ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ä¸€æ‹¬ç®¡ç†ãƒ„ãƒ¼ãƒ«</title>
      <!-- â–¼â–¼â–¼ ã“ã“ã‹ã‚‰OGPè¨­å®šã‚’è¿½åŠ  â–¼â–¼â–¼ -->
    <meta property="og:title" content="Mail Wizard - é«˜æ©Ÿèƒ½ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ä¸€æ‹¬ç®¡ç†ãƒ„ãƒ¼ãƒ«" />
    <meta property="og:description" content="CSV/Excelã‹ã‚‰ã®è²¼ã‚Šä»˜ã‘ã‚‚è‡ªå‹•è§£æï¼é‡è¤‡å‰Šé™¤ã€æ›¸å¼çµ±ä¸€ã€ãƒ‰ãƒ¡ã‚¤ãƒ³çµ±è¨ˆãªã©ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒªã‚¹ãƒˆç®¡ç†ã‚’åŠ‡çš„ã«åŠ¹ç‡åŒ–ã™ã‚‹ç„¡æ–™ãƒ„ãƒ¼ãƒ«ã€‚" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://yutools.net/mail-wizard/" />
    <meta property="og:image" content="https://yutools.net/mail-wizard/images/mail-wizard-icon.webp" />
    <meta property="og:site_name" content="YUTOOLS" />
    <meta name="twitter:card" content="summary_large_image" />
    <!-- â–²â–²â–² ã“ã“ã¾ã§OGPè¨­å®š â–²â–²â–² -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="/site-header.css">
    <script src="/js/header.js" async></script>
    <style>
        :root {
            --primary-color: #007bff; --secondary-color: #6c757d; --success-color: #28a745; --danger-color: #dc3545;
            --warning-color: #ffc107; --info-color: #17a2b8; --light-color: #f8f9fa; --dark-color: #343a40;
            --border-color: #dee2e6; --body-bg: #f8f9fa;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
         /* â–¼â–¼â–¼ ã“ã“ã«ã‚¢ã‚¤ã‚³ãƒ³ç”¨ã®CSSã‚’è¿½åŠ  â–¼â–¼â–¼ */
        .header-icon {
            height: 5rem; /* h1ã®æ–‡å­—ã‚µã‚¤ã‚ºã«åˆã‚ã›ã¦èª¿æ•´ */
            width: auto;
            vertical-align: middle; /* æ–‡å­—ã¨é«˜ã•ã‚’ä¸­å¤®æƒãˆã« */
            margin-right: 12px; /* ã‚¢ã‚¤ã‚³ãƒ³ã¨æ–‡å­—ã®é–“ã®ä½™ç™½ */
        }
        /* â–²â–²â–² ã“ã“ã¾ã§ â–²â–²â–² */
        body { font-family: 'Noto Sans JP', sans-serif; background-color: var(--body-bg); color: var(--dark-color); min-height: 100vh; padding: 20px; }
        .container { max-width: 1200px; margin: 20px auto; background: white; border-radius: 12px; box-shadow: 0 4px 25px rgba(0, 0, 0, 0.05); border: 1px solid var(--border-color); overflow: hidden; }
        .header { padding: 30px 40px; border-bottom: 1px solid var(--border-color); background-color: white; text-align: center; }
        .header h1 { font-size: 2.2rem; font-weight: 700; color: var(--dark-color); margin-bottom: 10px; }
        .header h1 .icon { color: var(--primary-color); }
        .header p { font-size: 1.1rem; color: var(--secondary-color); }
        .main-content { padding: 30px 40px; }
        .section { margin-bottom: 35px; }
        .section:last-child { margin-bottom: 0; }
        .section h2 { font-size: 1.5rem; font-weight: 700; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid var(--primary-color); display: inline-block; }
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; margin-bottom: 10px; font-weight: 500; font-size: 1rem; color: #495057; }
        select, input[type="text"], textarea { width: 100%; padding: 10px 15px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 14px; font-family: 'Menlo', 'Consolas', 'Courier New', monospace; transition: border-color 0.2s ease, box-shadow 0.2s ease; }
        textarea { resize: vertical; padding: 15px; }
        select { font-family: 'Noto Sans JP', sans-serif; padding: 12px 15px;}
        select:focus, input[type="text"]:focus, textarea:focus { outline: none; border-color: var(--primary-color); box-shadow: 0 0 0 4px rgba(0, 123, 255, 0.1); }
        textarea.drag-over { border-color: var(--primary-color); border-style: dashed; box-shadow: 0 0 15px rgba(0, 123, 255, 0.2); }
        .button-group { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 15px; }
        button { padding: 10px 20px; border: 1px solid transparent; border-radius: 8px; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; }
        .btn-primary { background-color: var(--primary-color); color: white; border-color: var(--primary-color); }
        .btn-primary:hover { background-color: #0069d9; border-color: #0062cc; }
        .btn-secondary { background-color: #f8f9fa; color: var(--dark-color); border-color: #ced4da; }
        .btn-secondary:hover { background-color: #e2e6ea; border-color: #dae0e5; }
        .btn-danger { background-color: var(--danger-color); color: white; border-color: var(--danger-color); }
        .btn-danger:hover { background-color: #c82333; border-color: #bd2130; }
        .btn-warning { background-color: var(--warning-color); color: #212529; border-color: var(--warning-color); }
        .btn-warning:hover { background-color: #e0a800; border-color: #d39e00; }
        .btn-info { background-color: var(--info-color); color: white; border-color: var(--info-color); }
        .btn-info:hover { background-color: #138496; border-color: #117a8b; }
        .stats { display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap; }
        .stat-item { background-color: var(--light-color); color: var(--dark-color); padding: 8px 15px; border-radius: 8px; font-size: 13px; font-weight: 500; border: 1px solid var(--border-color); }
        .advanced-options { display: none; margin-top: 20px; padding: 20px; background: #fcfcfc; border: 1px dashed var(--border-color); border-radius: 8px; }
        .advanced-options.show { display: block; }
        .settings-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        #domainStats { margin-top: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 30px; align-items: center;}
        #domainChartContainer { position: relative; max-width: 300px; margin: 0 auto; }
        #domainTableContainer h4 { margin-bottom: 10px; font-weight: 500; }
        #domainTableContainer table { width: 100%; border-collapse: collapse; }
        #domainTableContainer th, #domainTableContainer td { padding: 8px; text-align: left; border-bottom: 1px solid var(--border-color); font-size: 13px; vertical-align: middle;}
        #domainTableContainer th { font-weight: 500; }
        .btn-domain-copy { padding: 4px 10px; font-size: 12px; background-color: var(--secondary-color); color: white; border-color: var(--secondary-color); }
        .btn-domain-copy:hover { background-color: var(--dark-color); border-color: var(--dark-color); }
        .format-group { margin-top: 20px; padding: 20px; background-color: #f0f7ff; border: 1px solid #cce5ff; border-radius: 8px; }
        .format-group h3 { font-size: 1.1rem; margin-bottom: 15px;}
        .format-group p { font-size: 13px; color: var(--secondary-color); margin-top: 10px; line-height: 1.6; }
        .preset-buttons { margin-bottom: 15px; }
        .preset-buttons button { font-size: 12px; padding: 6px 12px; }
        .format-preview { margin-top: 15px; padding: 10px; background-color: white; border: 1px dashed var(--border-color); border-radius: 5px; font-size: 13px; font-family: 'Menlo', 'Consolas', 'Courier New', monospace; word-wrap: break-word; }
        .format-preview strong { font-weight: 500; color: var(--dark-color); }
        .accordion-guide { margin-bottom: 30px; border: 1px solid var(--border-color); border-radius: 8px; background-color: #fff; }
        .accordion-item { border-bottom: 1px solid var(--border-color); }
        .accordion-item:last-child { border-bottom: none; }
        .accordion-header { width: 100%; background-color: #f8f9fa; border: none; padding: 15px 20px; text-align: left; font-size: 1.1rem; font-weight: 500; color: var(--primary-color); cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .accordion-header:hover { background-color: #e9ecef; }
        .accordion-icon { font-size: 1.2rem; transition: transform 0.3s ease; }
        .accordion-header.active .accordion-icon { transform: rotate(45deg); }
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; background-color: white; }
        .accordion-content-inner { padding: 20px; font-size: 14px; line-height: 1.7; color: #495057; }
        .accordion-content-inner ul { list-style-position: inside; padding-left: 10px; margin-top: 10px; margin-bottom: 10px;}
        .accordion-content-inner code { background-color: #e9ecef; padding: 2px 5px; border-radius: 4px; font-family: 'Menlo', 'Consolas', 'Courier New', monospace; }
        .conversion-tool { display: flex; align-items: center; gap: 10px; margin-top: 10px; flex-wrap: wrap;}
        .conversion-tool select { flex-grow: 1; }
        .conversion-tool button { flex-shrink: 0; }
        #outputText { background-color: #fff; min-height: 200px; white-space: pre-wrap; word-wrap: break-word; padding: 15px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 14px; font-family: 'Menlo', 'Consolas', 'Courier New', monospace; line-height: 1.5; overflow-y: auto; }
        .output-line.warning-domain { color: var(--danger-color); font-weight: bold; }
        .output-line.warning-prefix { color: #fd7e14; }
        .output-line.warning-typo { color: #856404; font-style: italic; }
        #warningBox { display: none; padding: 15px; margin-bottom: 15px; border-radius: 8px; background-color: #fff3cd; border: 1px solid #ffeeba; color: #856404; font-weight: 500; }
        #warningBox ul { list-style-position: inside; margin-top: 10px; }
        #warningBox .typo-fix-btn { margin-left: 10px; font-size: 12px; padding: 2px 8px; }
        #smartParseNotice { display: none; padding: 15px; margin-bottom: 15px; border-radius: 8px; background-color: #d1ecf1; border: 1px solid #bee5eb; color: #0c5460;}
        .recipe-group .button-group { justify-content: flex-start; }
        .recipe-list-item { display: flex; justify-content: space-between; align-items: center; padding: 5px 0; }
        @media (max-width: 992px) { #domainStats { grid-template-columns: 1fr; } }
        @media (max-width: 768px) {
            body { padding: 10px; } .container { margin: 10px auto; } .header { padding: 25px; } .main-content { padding: 20px; } .header h1 { font-size: 1.8rem; }
            .button-group { flex-direction: column; } button { width: 100%; }
            .recipe-group .button-group, .preset-buttons { flex-direction: row; } .recipe-group .button-group button, .preset-buttons button { width: auto; }
        }
    </style>
</head>
<body>
    <div id="header-placeholder"></div>
    <div class="container">
        <header class="header">
            <h1><img src="/mail-wizard/images/mail-wizard-icon.webp" alt="Mail Wizard icon" class="header-icon">Mail Wizard</h1>
            <p>é«˜æ©Ÿèƒ½ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ä¸€æ‹¬ç®¡ç†ï¼†æ•´å½¢ãƒ„ãƒ¼ãƒ«</p>
        </header>

        <main class="main-content">
             <section class="accordion-guide">
                <div class="accordion-item">
                    <button class="accordion-header"><span>âœ¨ ä¸»ãªæ©Ÿèƒ½ãƒã‚¤ãƒ©ã‚¤ãƒˆ</span><span class="accordion-icon">+</span></button>
                    <div class="accordion-content">
                        <div class="accordion-content-inner">
                            <p>Mail Wizardã¯ã•ã‚‰ã«å¼·åŠ›ã«é€²åŒ–ã—ã¾ã—ãŸï¼</p>
                            <ul>
                                <li><strong>ã‚¹ãƒãƒ¼ãƒˆå…¥åŠ›è§£æ:</strong> CSVã‚„Excelã‹ã‚‰ã‚³ãƒ”ãƒ¼ã—ãŸ `åå‰,ãƒ¡ãƒ¼ãƒ«` å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘ã‚‹ã¨ã€è‡ªå‹•ã§è§£é‡ˆã—ã¦å–ã‚Šè¾¼ã¿ã¾ã™ã€‚</li>
                                <li><strong>ãƒ¬ã‚·ãƒ”æ©Ÿèƒ½:</strong> ä¸€é€£ã®æ“ä½œï¼ˆé‡è¤‡å‰Šé™¤â†’åå‰æŠ½å‡ºâ†’ã‚«ãƒŠå¤‰æ›ãªã©ï¼‰ã‚’ã€Œãƒ¬ã‚·ãƒ”ã€ã¨ã—ã¦ä¿å­˜ã—ã€ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§å†ç¾ã§ãã¾ã™ã€‚</li>
                                <li><strong>ã‚¿ã‚¤ãƒ—ãƒŸã‚¹æ¤œå‡ºï¼†ä¿®æ­£:</strong> `gmai.com`ã®ã‚ˆã†ãªãƒ‰ãƒ¡ã‚¤ãƒ³ã®æ‰“ã¡é–“é•ã„ã‚’æ¤œå‡ºã—ã€ãƒœã‚¿ãƒ³ä¸€ã¤ã§ä¿®æ­£ã§ãã¾ã™ã€‚</li>
                                <li><strong>ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼:</strong> è‡ªåˆ†ã ã‘ã®NGãƒ‰ãƒ¡ã‚¤ãƒ³ã‚„NGãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’ã€Œè©³ç´°è¨­å®šã€ã‹ã‚‰ç™»éŒ²ã§ãã¾ã™ã€‚</li>
                                <li><strong>ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¿å­˜:</strong> ãƒšãƒ¼ã‚¸ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚‚å…¥åŠ›æ¬„ã®å†…å®¹ãŒæ¶ˆãˆã¾ã›ã‚“ã€‚</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>ğŸ“– Mail Wizardã®ä½¿ã„æ–¹</span>
                        <span class="accordion-icon">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-content-inner">
                            <p>ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒªã‚¹ãƒˆã‚’æ§˜ã€…ãªå½¢å¼ã«ä¸€æ‹¬ã§å¤‰æ›ãƒ»æ•´å½¢ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚</p>
                            <ul>
                                <li><strong>å…¥åŠ›:</strong> å·¦ä¸Šã®å…¥åŠ›æ¬„ã«ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒªã‚¹ãƒˆã‚’è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚</li>
                                <li><strong>å‡¦ç†:</strong> ã€Œå‡¦ç†ã‚’é¸æŠã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã€å¥½ããªå½¢å¼ã«å¤‰æ›ã—ã¾ã™ã€‚</li>
                                <li><strong>çµæœ:</strong> ä¸‹ã®ã€Œå‡¦ç†çµæœã€æ¬„ã«æ•´å½¢ã•ã‚ŒãŸãƒªã‚¹ãƒˆãŒå‡ºåŠ›ã•ã‚Œã¾ã™ã€‚ã‚³ãƒ”ãƒ¼ã‚„ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ã‚‚å¯èƒ½ã§ã™ã€‚</li>
                            </ul>
                            <p>å„æ©Ÿèƒ½ã®è©³ç´°ã¯ã€ä¸‹ã®é …ç›®ã‚’é–‹ã„ã¦ã”ç¢ºèªãã ã•ã„ã€‚</p>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>âš™ï¸ è©³ç´°è¨­å®šã¨ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½ã«ã¤ã„ã¦</span>
                        <span class="accordion-icon">+</span>
                    </button>
                     <div class="accordion-content">
                        <div class="accordion-content-inner">
                            <p>ã€Œè©³ç´°è¨­å®šã€ã§ã¯ã€å‡¦ç†ã®å‰ã«è¡Œã†å…±é€šã®ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®šã§ãã¾ã™ã€‚</p>
                            <ul>
                                <li><strong>ã‚½ãƒ¼ãƒˆé †:</strong> å‡¦ç†çµæœã‚’ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚„åå‰ã®ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«ä¸¦ã¹æ›¿ãˆã¾ã™ã€‚</li>
                                <li><strong>é‡è¤‡å‰Šé™¤:</strong> åŒã˜ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒè¤‡æ•°ã‚ã‚‹å ´åˆã€ä¸€ã¤ã«ã¾ã¨ã‚ã¾ã™ã€‚</li>
                                <li><strong>ç„¡åŠ¹ãªå½¢å¼ã‚’é™¤å¤–:</strong> <code>@</code> ãŒãªã„ãªã©ã€æ˜ã‚‰ã‹ã«ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å½¢å¼ã§ãªã„ã‚‚ã®ã‚’é™¤å¤–ã—ã¾ã™ã€‚</li>
                                <li><strong>ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼:</strong> è‡ªåˆ†ã ã‘ã®NGãƒªã‚¹ãƒˆï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³ã€ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ï¼‰ã‚’è¿½åŠ ã§ãã¾ã™ã€‚</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>ğŸª„ ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ©Ÿèƒ½ã¨ã¯ï¼Ÿ</span>
                        <span class="accordion-icon">+</span>
                    </button>
                     <div class="accordion-content">
                        <div class="accordion-content-inner">
                            <p>æ±ºã¾ã£ãŸå½¢å¼ã ã‘ã§ãªãã€ã‚ãªãŸã ã‘ã®ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’ä½œæˆã§ãã‚‹æ©Ÿèƒ½ã§ã™ã€‚</p>
                            <p><code>{name}</code>, <code>{email}</code>, <code>{lastName}</code> (å§“), <code>{firstName}</code> (å) ã¨ã„ã†ã€Œãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã€ã‚’ä½¿ã„ã€è‡ªç”±ãªæ–‡å­—åˆ—ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
                            <ul>
                                <li><strong>ä¾‹1:</strong> ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã« <code>{email} ({name})</code> ã¨å…¥åŠ› â†’ <code>tanaka@example.com (ç”°ä¸­ å¤ªéƒ)</code> ã®å½¢å¼ã§å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚ï¼ˆåå‰ãŒãªã„è¡Œã¯ <code>email@example.com ()</code> ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼‰</li>
                                <li><strong>ä¾‹2:</strong> ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã« <code>ã€æ°åã€‘{lastName} ã€ãƒ¡ãƒ¼ãƒ«ã€‘{email}</code> ã¨å…¥åŠ› â†’ <code>ã€æ°åã€‘ç”°ä¸­ ã€ãƒ¡ãƒ¼ãƒ«ã€‘tanaka@example.com</code> ã®å½¢å¼ã§å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚</li>
                            </ul>
                            <p>ãƒ—ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ã‚„ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ´»ç”¨ã—ã¦ã€ãœã²è‰²ã€…ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’ãŠè©¦ã—ãã ã•ã„ï¼</p>
                        </div>
                    </div>
                </div>
                 <div class="accordion-item">
                    <button class="accordion-header">
                        <span>ğŸ“Š ãƒ‰ãƒ¡ã‚¤ãƒ³çµ±è¨ˆæ©Ÿèƒ½</span>
                        <span class="accordion-icon">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-content-inner">
                            <p>å‡¦ç†çµæœã®ä¸‹ã«è¡¨ç¤ºã•ã‚Œã‚‹å††ã‚°ãƒ©ãƒ•ã¨è¡¨ã¯ã€å…¥åŠ›ã•ã‚ŒãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆ<code>@</code>ä»¥é™ã®éƒ¨åˆ†ï¼‰ã‚’é›†è¨ˆã—ãŸã‚‚ã®ã§ã™ã€‚</p>
                            <ul>
                                <li>ã©ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒã©ã‚Œãã‚‰ã„ã®å‰²åˆã‚’å ã‚ã¦ã„ã‚‹ã‹ã€ä¸€ç›®ã§ç¢ºèªã§ãã¾ã™ã€‚</li>
                                <li>è¡¨ã®å³å´ã«ã‚ã‚‹ã€Œã‚³ãƒ”ãƒ¼ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ãã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã ã‘ã‚’ã¾ã¨ã‚ã¦ã‚³ãƒ”ãƒ¼ã§ãã¾ã™ã€‚</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="accordion-item">
                    <button class="accordion-header">
                        <span>ğŸ”’ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã«ã¤ã„ã¦</span>
                        <span class="accordion-icon">+</span>
                    </button>
                    <div class="accordion-content">
                        <div class="accordion-content-inner">
                            <p>ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€ã™ã¹ã¦ã®å‡¦ç†ã‚’ã‚ãªãŸã®ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å®Œçµã•ã›ã¾ã™ã€‚å…¥åŠ›ã•ã‚ŒãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚„ãã®ä»–ã®ãƒ‡ãƒ¼ã‚¿ãŒã€é–‹ç™ºè€…ã‚’å«ã‚€å¤–éƒ¨ã®ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ãƒ»ä¿å­˜ã•ã‚Œã‚‹ã“ã¨ã¯ä¸€åˆ‡ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <section class="section">
                <h2>1. ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å…¥åŠ›</h2>
                <div id="smartParseNotice"></div>
                <div class="input-group">
                    <label for="inputText">ä¸€è¦§ã‚’è²¼ã‚Šä»˜ã‘ã‚‹ã‹ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ãã ã•ã„ (CSV/TSVè²¼ã‚Šä»˜ã‘å¯¾å¿œ):</label>
                    <textarea id="inputText" rows="10" placeholder="ä¾‹ï¼šç”°ä¸­å¤ªéƒ <tanaka@example.com>..."></textarea>
                </div>
                <div class="button-group">
                    <button class="btn-secondary" onclick="toggleAdvanced()">âš™ï¸ è©³ç´°è¨­å®šã®è¡¨ç¤º/éè¡¨ç¤º</button>
                    <button class="btn-danger" onclick="clearInput()">ğŸ—‘ï¸ ã™ã¹ã¦ã‚¯ãƒªã‚¢</button>
                    <button class="btn-secondary" onclick="loadSampleData()">ğŸ“‹ ã‚µãƒ³ãƒ—ãƒ«å…¥åŠ›</button>
                </div>
                <div id="advancedOptions" class="advanced-options show">
                    <h3>è©³ç´°è¨­å®š</h3>
                    <div class="settings-grid">
                        <div class="input-group">
                            <label for="sortOrder">ã‚½ãƒ¼ãƒˆé †</label>
                            <select id="sortOrder">
                                <option value="none">ã‚½ãƒ¼ãƒˆã—ãªã„</option>
                                <option value="email_asc">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ (Aâ†’Z)</option>
                                <option value="name_asc">åå‰ (Aâ†’Z)</option>
                            </select>
                        </div>
                         <div class="input-group">
                            <label>åŸºæœ¬ã‚ªãƒ—ã‚·ãƒ§ãƒ³</label>
                            <div style="display: flex; flex-direction: column; gap: 10px;">
                                <div style="display: flex; align-items: center; gap: 8px;"><input type="checkbox" id="removeDuplicates" checked><label for="removeDuplicates">é‡è¤‡ã—ãŸã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å‰Šé™¤</label></div>
                                <div style="display: flex; align-items: center; gap: 8px;"><input type="checkbox" id="validateEmails" checked><label for="validateEmails">ç„¡åŠ¹ãªå½¢å¼ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’é™¤å¤–</label></div>
                            </div>
                        </div>
                        <div class="input-group">
                            <label for="customSpamDomains">ã‚«ã‚¹ã‚¿ãƒ NGãƒ‰ãƒ¡ã‚¤ãƒ³ (æ”¹è¡ŒåŒºåˆ‡ã‚Š)</label>
                            <textarea id="customSpamDomains" rows="3" placeholder="example.net
block-this.com"></textarea>
                        </div>
                        <div class="input-group">
                            <label for="customNgPrefixes">ã‚«ã‚¹ã‚¿ãƒ NGãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ (æ”¹è¡ŒåŒºåˆ‡ã‚Š, @å«ã‚€)</label>
                            <textarea id="customNgPrefixes" rows="3" placeholder="billing@
invoice@"></textarea>
                        </div>
                    </div>
                </div>
            </section>

            <section class="section">
                <h2>2. åŸºæœ¬å‡¦ç†</h2>
                <div class="button-group">
                    <button class="btn-primary" onclick="runAndRecord('extractEmails')">ğŸ“§ ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ã¿æŠ½å‡º</button>
                    <button class="btn-primary" onclick="runAndRecord('extractNames')">ğŸ‘¤ åå‰ã®ã¿æŠ½å‡º</button>
                    <button class="btn-primary" onclick="runAndRecord('extractBoth')">ğŸ“‹ åå‰ã¨ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æŠ½å‡º</button>
                </div>
                <div class="format-group">
                    <h3>ğŸª„ ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ</h3>
                    <p>
                        ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼: <code>{email}</code>, <code>{name}</code>, <code>{lastName}</code> (å§“), <code>{firstName}</code> (å)
                    </p>
                    <div class="preset-buttons button-group">
                        <button class="btn-secondary" onclick="setCustomTemplate('{email} ({name})')">ãƒ¡ãƒ«ã‚¢ãƒ‰ (åå‰)</button>
                        <button class="btn-secondary" onclick="setCustomTemplate('{name} <{email}>')">åå‰ <ãƒ¡ãƒ«ã‚¢ãƒ‰></button>
                        <button class="btn-secondary" onclick="setCustomTemplate('{lastName}æ§˜ <{email}>')">å§“æ§˜ <ãƒ¡ãƒ«ã‚¢ãƒ‰></button>
                    </div>
                    <div class="input-group">
                        <label for="customFormatInput">ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ:</label>
                        <input type="text" id="customFormatInput" placeholder="ä¾‹: {email} ({lastName} {firstName})">
                    </div>
                    <div class="format-preview"><strong>ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼:</strong> <span id="formatPreviewOutput">ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</span></div>
                    <div class="button-group">
                        <button class="btn-primary" onclick="runAndRecord('applyCustomFormat')">ğŸ“ ã“ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’é©ç”¨</button>
                    </div>
                </div>
            </section>
            
            <section class="section">
                <h2>3. ãƒ¬ã‚·ãƒ”ï¼ˆé€£ç¶šå‡¦ç†ï¼‰</h2>
                <p style="font-size: 13px; color: var(--secondary-color); margin-bottom: 20px;">
                    â€»è¨­å®šã‚„ãƒ¬ã‚·ãƒ”ã¯ã€ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶å†…ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼‰ã«ã®ã¿ä¿å­˜ã•ã‚Œã¾ã™ã€‚ä»–ã®PCã‚„ãƒ–ãƒ©ã‚¦ã‚¶ã¨ã¯å…±æœ‰ã•ã‚Œã¾ã›ã‚“ã€‚
                </p>
                <div class="format-group recipe-group" style="background-color: #fdf8e6;">
                    <p>ä¸€é€£ã®æ“ä½œã‚’ã€Œãƒ¬ã‚·ãƒ”ã€ã¨ã—ã¦ä¿å­˜ã—ã€ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§å®Ÿè¡Œã§ãã¾ã™ã€‚</p>
                    <div class="button-group">
                        <button id="recordBtn" class="btn-info" onclick="toggleRecording()">âºï¸ è¨˜éŒ²é–‹å§‹</button>
                        <button class="btn-secondary" onclick="saveRecipe()">ğŸ’¾ ç¾åœ¨ã®ãƒ¬ã‚·ãƒ”ã‚’ä¿å­˜</button>
                    </div>
                    <div class="input-group" style="margin-top: 20px;">
                        <label for="recipeList">ä¿å­˜ã—ãŸãƒ¬ã‚·ãƒ”:</label>
                        <select id="recipeList"></select>
                    </div>
                     <div class="button-group">
                        <button class="btn-warning" onclick="runRecipe()">â–¶ï¸ é¸æŠã—ãŸãƒ¬ã‚·ãƒ”ã‚’å®Ÿè¡Œ</button>
                        <button class="btn-danger" onclick="deleteRecipe()">ğŸ—‘ï¸ é¸æŠã—ãŸãƒ¬ã‚·ãƒ”ã‚’å‰Šé™¤</button>
                    </div>
                </div>
            </section>

            <section class="section">
                <h2>4. ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆè£œæ­£ï¼†å¤‰æ›</h2>
                <p style="font-size: 14px; color: var(--secondary-color); margin-bottom: 20px;">â€»ä¸‹ã®ãƒ„ãƒ¼ãƒ«ã¯ã€ã€Œå‡¦ç†çµæœã€æ¬„ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ç›´æ¥æ•´å½¢ãƒ»å¤‰æ›ã—ã¾ã™ã€‚</p>
                <div class="format-group" style="background-color: #f0f7ff;">
                    <h3>åå‰ã®è£œæ­£</h3>
                    <div class="button-group">
                        <button class="btn-secondary" onclick="runAndRecord('capitalizeNames')">å§“åã®é ­æ–‡å­—ã‚’å¤§æ–‡å­—ã« (abcâ†’Abc)</button>
                        <button class="btn-secondary" onclick="runAndRecord('removeSpaces')">ã™ã¹ã¦ã®ã‚¹ãƒšãƒ¼ã‚¹ã‚’å‰Šé™¤</button>
                        <button class="btn-secondary" onclick="runAndRecord('convertToFullWidthKana')">åŠè§’ã‚«ãƒŠ â†’ å…¨è§’ã‚«ãƒŠ</button>
                        <button class="btn-secondary" onclick="runAndRecord('convertToHalfWidthAlpha')">å…¨è§’è‹±æ•° â†’ åŠè§’è‹±æ•°</button>
                    </div>
                </div>
                <div class="format-group" style="background-color: #f8f9fa; margin-top:20px;">
                    <h3>ãƒ†ã‚­ã‚¹ãƒˆå…¨ä½“ã®å¤‰æ›</h3>
                    <div class="button-group">
                         <button class="btn-secondary" onclick="runAndRecord('convertToLowercase')">ã™ã¹ã¦å°æ–‡å­—ã«å¤‰æ›</button>
                         <button class="btn-secondary" onclick="runAndRecord('unifyEmailCase', 'lowercase_all')">ãƒ¡ãƒ«ã‚¢ãƒ‰ã‚’å°æ–‡å­—ã«çµ±ä¸€</button>
                         <button class="btn-secondary" onclick="runAndRecord('convertToHtmlLink')">HTMLãƒªãƒ³ã‚¯ (mailto) ã«å¤‰æ›</button>
                    </div>
                     <div class="conversion-tool">
                        <select id="fromSeparator"><option value="\n">æ”¹è¡Œ</option><option value=",">ã‚«ãƒ³ãƒ (,)</option><option value=";">ã‚»ãƒŸã‚³ãƒ­ãƒ³ (;)</option><option value=" ">åŠè§’ã‚¹ãƒšãƒ¼ã‚¹</option><option value="\t">ã‚¿ãƒ–</option></select>
                        <span style="font-weight: bold; font-size: 1.2rem;">â†’</span>
                        <select id="toSeparator"><option value="\n">æ”¹è¡Œ</option><option value=",">ã‚«ãƒ³ãƒ (,)</option><option value=";">ã‚»ãƒŸã‚³ãƒ­ãƒ³ (;)</option><option value=" ">åŠè§’ã‚¹ãƒšãƒ¼ã‚¹</option><option value="\t">ã‚¿ãƒ–</option></select>
                        <button class="btn-secondary" onclick="runAndRecord('convertSeparators')">åŒºåˆ‡ã‚Šæ–‡å­—ã‚’å¤‰æ›</button>
                    </div>
                </div>
            </section>

            <section class="section">
                <h2>5. å‡¦ç†çµæœ</h2>
                <div id="warningBox"></div>
                <div class="input-group">
                    <label for="outputText">çµæœã¯ã“ã¡ã‚‰ã«å‡ºåŠ›ã•ã‚Œã¾ã™ï¼š</label>
                    <div id="outputText" class="output-area" readonly></div>
                </div>
                <div class="button-group">
                    <button class="btn-primary" onclick="copyToClipboard(this, document.getElementById('outputText').textContent)">ğŸ“‹ ã™ã¹ã¦ã‚³ãƒ”ãƒ¼</button>
                    <button id="batchCopyBtn" class="btn-primary" onclick="copyBatch()" style="display: none;">ğŸ“‹ 50ä»¶ãšã¤ã‚³ãƒ”ãƒ¼</button>
                    <button class="btn-secondary" onclick="swapInputOutput()">ğŸ”„ çµæœã‚’å…¥åŠ›ã«ç§»å‹•</button>
                </div>
                 <div class="button-group">
                    <button class="btn-secondary" onclick="downloadFile(document.getElementById('outputText').textContent, 'email-list.txt', 'text/plain')">ğŸ’¾ .txtã§ä¿å­˜</button>
                    <button class="btn-secondary" onclick="downloadAsCsv()">ğŸ’¾ .csvã§ä¿å­˜</button>
                    <button class="btn-secondary" onclick="downloadAsJson()">ğŸ’¾ .jsonã§ä¿å­˜</button>
                </div>
                <div class="stats" id="stats"></div>
                <div id="domainStats">
                    <div id="domainChartContainer"><canvas id="domainChart"></canvas></div>
                    <div id="domainTableContainer"></div>
                </div>
            </section>
        </main>
    </div>

    <script>
        // --- ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã¨å®šæ•° ---
        let processedData = [];
        let currentBatchIndex = 0;
        let domainChartInstance = null;
        let isRecording = false;
        let currentRecipe = [];
        const SPAM_DOMAINS = ['temp-mail.org', '10minutemail.com', 'guerrillamail.com', 'mailinator.com', 'getnada.com', 'throwawaymail.com', 'mohmal.com', 'yopmail.com'];
        const NG_PREFIXES = ['admin@', 'noreply@', 'no-reply@', 'support@', 'info@', 'contact@', 'abuse@', 'postmaster@', 'help@', 'sales@', 'test@', 'demo@'];
        const TYPO_DOMAINS = { 'gmai.com': 'gmail.com', 'gmal.com': 'gmail.com', 'gmail.con': 'gmail.com', 'gmil.com': 'gmail.com', 'yaho.co.jp': 'yahoo.co.jp', 'yahoo.ne.jp': 'yahoo.co.jp', 'icloud.con': 'icloud.com', 'hotmai.com': 'hotmail.com', 'outlook.con': 'outlook.com' };

        // --- åˆæœŸåŒ–å‡¦ç† ---
        document.addEventListener('DOMContentLoaded', () => {
            loadSettings();
            setupDragAndDrop();
            setupAccordion();
            setupEventListeners();
            loadRecipes();
            const savedInput = localStorage.getItem('yutools-mail-wizard-savedInput');
            if (savedInput) document.getElementById('inputText').value = savedInput;
        });

        function setupEventListeners() {
            const idsToSave = ['removeDuplicates', 'validateEmails', 'sortOrder', 'customSpamDomains', 'customNgPrefixes'];
            idsToSave.forEach(id => document.getElementById(id).addEventListener('change', saveSettings));
            
            document.getElementById('domainTableContainer').addEventListener('click', (e) => {
                if (e.target.classList.contains('btn-domain-copy')) copyDomainEmails(e.target.dataset.domain, e.target);
            });
            document.getElementById('customFormatInput').addEventListener('input', updateFormatPreview);
            
            const inputText = document.getElementById('inputText');
            inputText.addEventListener('input', () => localStorage.setItem('yutools-mail-wizard-savedInput', inputText.value));
            inputText.addEventListener('paste', handlePaste);

            document.getElementById('warningBox').addEventListener('click', (e) => {
                if (e.target.classList.contains('typo-fix-btn')) {
                    const original = e.target.dataset.original;
                    const suggestion = e.target.dataset.suggestion;
                    fixTypo(original, suggestion);
                }
            });
        }

        // --- UIé–¢é€£ (ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ã€D&D) ---
        function setupAccordion() { document.querySelectorAll('.accordion-header').forEach(h => h.addEventListener('click', () => { const c = h.nextElementSibling; h.classList.toggle('active'); c.style.maxHeight = c.style.maxHeight ? null : c.scrollHeight + 'px'; })); }
        function setupDragAndDrop() {
            const el = document.getElementById('inputText');
            el.addEventListener('dragover', (e) => { e.preventDefault(); el.classList.add('drag-over'); });
            el.addEventListener('dragleave', () => el.classList.remove('drag-over'));
            el.addEventListener('drop', (e) => {
                e.preventDefault(); el.classList.remove('drag-over');
                if (e.dataTransfer.files.length > 0) {
                    const reader = new FileReader();
                    reader.onload = (ev) => { el.value = ev.target.result; el.dispatchEvent(new Event('input')); };
                    reader.readAsText(e.dataTransfer.files[0]);
                }
            });
        }

        // --- è¨­å®šã®ä¿å­˜ãƒ»èª­è¾¼ ---
        function saveSettings() {
            const settings = {
                removeDuplicates: document.getElementById('removeDuplicates').checked,
                validateEmails: document.getElementById('validateEmails').checked,
                sortOrder: document.getElementById('sortOrder').value,
                customSpamDomains: document.getElementById('customSpamDomains').value,
                customNgPrefixes: document.getElementById('customNgPrefixes').value
            };
            localStorage.setItem('yutools-mail-wizard-settings', JSON.stringify(settings));
        }

        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem('yutools-mail-wizard-settings'));
            if (settings) {
                document.getElementById('removeDuplicates').checked = settings.removeDuplicates !== false;
                document.getElementById('validateEmails').checked = settings.validateEmails !== false;
                document.getElementById('sortOrder').value = settings.sortOrder || 'none';
                document.getElementById('customSpamDomains').value = settings.customSpamDomains || '';
                document.getElementById('customNgPrefixes').value = settings.customNgPrefixes || '';
            }
        }

        // --- ã‚¹ãƒãƒ¼ãƒˆå…¥åŠ›è§£æ ---
        function handlePaste(e) {
            const pasteData = (e.clipboardData || window.clipboardData).getData('text');
            const lines = pasteData.split('\n').filter(l => l.trim() !== '');
            if (lines.length < 2) return;

            const separator = lines[0].includes(',') ? ',' : (lines[0].includes('\t') ? '\t' : null);
            if (!separator) return;

            const columns = lines[0].split(separator).length;
            if (columns < 2) return;

            let emailCol = -1, nameCol = -1;
            const firstRow = lines[0].split(separator);
            for(let i=0; i<columns; i++) {
                if(validateEmail(firstRow[i].trim())) emailCol = i;
                else if (firstRow[i].trim().length > 0) nameCol = i;
            }

            if (emailCol !== -1) {
                e.preventDefault();
                const formattedText = lines.map(line => {
                    const parts = line.split(separator);
                    const email = (parts[emailCol] || '').trim();
                    const name = nameCol !== -1 ? (parts[nameCol] || '').trim().replace(/^["']|["']$/g, '') : '';
                    if (validateEmail(email)) {
                        return name ? `"${name}" <${email}>` : email;
                    }
                    return null;
                }).filter(Boolean).join('\n');
                
                document.getElementById('inputText').value = formattedText;
                document.getElementById('inputText').dispatchEvent(new Event('input'));

                const notice = document.getElementById('smartParseNotice');
                notice.textContent = `âœ… ${separator === ',' ? 'CSV' : 'TSV'}å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œå‡ºã—ã€è‡ªå‹•ã§æ•´å½¢ã—ã¾ã—ãŸã€‚`;
                notice.style.display = 'block';
                setTimeout(() => notice.style.display = 'none', 5000);
            }
        }
        
        // --- â–¼â–¼â–¼ ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã®ä¸­æ ¸ (ãƒ­ã‚¸ãƒƒã‚¯å…¨é¢è¦‹ç›´ã—) â–¼â–¼â–¼ ---
        function parseEmailEntry(entry) {
            entry = entry.trim();
            if (!entry) return null;

            const createDataObject = (email, name = '') => {
                const cleanedName = name.trim().replace(/^["']|["']$/g, '').replace(/[\s<>()\[\]:;,"']+$|^[\s<>()\[\]:;,"']+/g, '').trim();
                const hasExplicitName = cleanedName.length > 0;
                const nameParts = hasExplicitName ? cleanedName.split(/[\sã€€]+/) : [];
                return {
                    name: hasExplicitName ? cleanedName : '',
                    email: email.trim(),
                    lastName: hasExplicitName ? nameParts[0] || '' : '',
                    firstName: hasExplicitName ? nameParts.slice(1).join(' ') : '',
                    hasExplicitName: hasExplicitName
                };
            };

            // ãƒ‘ã‚¿ãƒ¼ãƒ³1: "åå‰" <ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹> (æœ€å„ªå…ˆ)
            const rfcMatch = entry.match(/^(.*?)<(.+?)>$/);
            if (rfcMatch) {
                const name = rfcMatch[1];
                const email = rfcMatch[2];
                if (validateEmail(email.trim())) {
                    return createDataObject(email, name);
                }
            }
            
            // ãƒ‘ã‚¿ãƒ¼ãƒ³2: ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’æ–‡å­—åˆ—ã‹ã‚‰æ¢ã—å‡ºã—ã€æ®‹ã‚Šã‚’åå‰ã«ã™ã‚‹
            const emailRegex = /[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/;
            const emailMatch = entry.match(emailRegex);

            if (emailMatch) {
                const email = emailMatch[0];
                const namePart = entry.replace(email, ' ').trim();
                return createDataObject(email, namePart);
            }
            
            return null; // ã©ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã‚‚ä¸€è‡´ã—ãªã„
        }
        // --- â–²â–²â–² ãƒ‡ãƒ¼ã‚¿å‡¦ç†ã®ä¸­æ ¸ (ãƒ­ã‚¸ãƒƒã‚¯å…¨é¢è¦‹ç›´ã—) â–²â–²â–² ---


        function validateEmail(email) { return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(email).toLowerCase()); }
        
        function processInput() {
            const customSpam = document.getElementById('customSpamDomains').value.split('\n').filter(Boolean);
            const customPrefixes = document.getElementById('customNgPrefixes').value.split('\n').filter(Boolean);
            const allSpamDomains = [...SPAM_DOMAINS, ...customSpam];
            const allNgPrefixes = [...NG_PREFIXES, ...customPrefixes];
            
            const entries = document.getElementById('inputText').value.split(/[\n,;]+/).map(e => e.trim()).filter(e => e);
            let data = [];
            for (const entry of entries) {
                let parsed = parseEmailEntry(entry);
                if (parsed && (!document.getElementById('validateEmails').checked || validateEmail(parsed.email))) {
                    parsed.originalEmail = parsed.email;
                    parsed.warnings = [];
                    const emailLower = parsed.email.toLowerCase();
                    const domain = emailLower.split('@')[1];
                    
                    if (allSpamDomains.includes(domain)) parsed.warnings.push({type: 'domain'});
                    if (allNgPrefixes.some(p => emailLower.startsWith(p))) parsed.warnings.push({type: 'prefix'});
                    if (TYPO_DOMAINS[domain]) parsed.warnings.push({type: 'typo', suggestion: parsed.email.replace(domain, TYPO_DOMAINS[domain])});
                    
                    data.push(parsed);
                }
            }
            if (document.getElementById('removeDuplicates').checked) {
                const seen = new Set();
                data = data.filter(item => {
                    const key = item.email.toLowerCase();
                    return seen.has(key) ? false : (seen.add(key), true);
                });
            }
            
            const sortOrder = document.getElementById('sortOrder').value;
            if (sortOrder === 'email_asc') data.sort((a, b) => a.email.localeCompare(b.email, 'en'));
            if (sortOrder === 'name_asc') data.sort((a, b) => (a.name || '').localeCompare(b.name || '', 'ja'));
            
            processedData = data;
            updateFormatPreview();
            return data;
        }
        
        function fixTypo(original, suggestion) {
            const inputText = document.getElementById('inputText');
            inputText.value = inputText.value.replace(new RegExp(original, 'g'), suggestion);
            inputText.dispatchEvent(new Event('input'));
            
            const dataToUpdate = processedData.find(d => d.originalEmail === original);
            if (dataToUpdate) {
                dataToUpdate.email = suggestion;
                dataToUpdate.originalEmail = suggestion;
                dataToUpdate.warnings = dataToUpdate.warnings.filter(w => w.type !== 'typo');
            }

            const outputDiv = document.getElementById('outputText');
            outputDiv.querySelectorAll('.output-line').forEach(lineDiv => {
                if (lineDiv.textContent.includes(original)) {
                    lineDiv.textContent = lineDiv.textContent.replace(new RegExp(original, 'g'), suggestion);
                }
            });

            updateWarningBox(processedData);
            updateDomainStats(processedData);
        }
        
        // --- åŸºæœ¬å‡¦ç† & ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ (ãƒ­ã‚¸ãƒƒã‚¯ä¿®æ­£) ---
        function extractEmails() { displayOutput(processInput().map(item => item.email), 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹'); }
        function extractNames() { displayOutput(processInput().filter(item => item.hasExplicitName).map(item => item.name), 'åå‰'); }
        function extractBoth() { displayOutput(processInput().map(item => item.hasExplicitName ? `${item.name}: ${item.email}` : item.email), 'é …ç›®'); }
        function setCustomTemplate(template) { document.getElementById('customFormatInput').value = template; updateFormatPreview(); }
        
        function updateFormatPreview() {
            const template = document.getElementById('customFormatInput').value;
            const previewSpan = document.getElementById('formatPreviewOutput');
            if (!template) { previewSpan.textContent = 'ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å…¥åŠ›ã¾ãŸã¯é¸æŠã—ã¦ãã ã•ã„'; return; }
            const previewData = processedData.length > 0 && processedData.some(d => d.hasExplicitName) 
                ? processedData.find(d => d.hasExplicitName) 
                : { name: "å±±ç”° å¤ªéƒ", email: "yamada@example.com", lastName: "å±±ç”°", firstName: "å¤ªéƒ", hasExplicitName: true };

            previewSpan.textContent = template
                .replace(/{email}/g, previewData.email)
                .replace(/{name}/g, previewData.hasExplicitName ? previewData.name : '')
                .replace(/{lastName}/g, previewData.hasExplicitName ? previewData.lastName : '')
                .replace(/{firstName}/g, previewData.hasExplicitName ? previewData.firstName : '');
        }

        function applyCustomFormat() {
            const template = document.getElementById('customFormatInput').value;
            if (!template) { alert('ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚'); return; }
            const data = processInput();
            const result = data.map(item => {
                return template
                    .replace(/{email}/g, item.email)
                    .replace(/{name}/g, item.hasExplicitName ? item.name : '')
                    .replace(/{lastName}/g, item.hasExplicitName ? item.lastName : '')
                    .replace(/{firstName}/g, item.hasExplicitName ? item.firstName : '');
            });
            displayOutput(result, 'ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ');
        }

        // --- å‡ºåŠ›ã¨çµ±è¨ˆè¡¨ç¤º ---
        function displayOutput(dataArray, type) {
            const outputDiv = document.getElementById('outputText');
            outputDiv.innerHTML = ''; 

            dataArray.forEach(lineText => {
                const lineDiv = document.createElement('div');
                lineDiv.className = 'output-line';
                lineDiv.textContent = lineText;
                
                const correspondingData = processedData.find(d => lineText.includes(d.originalEmail));
                if (correspondingData && correspondingData.warnings.length > 0) {
                    if (correspondingData.warnings.some(w => w.type === 'domain')) lineDiv.classList.add('warning-domain');
                    if (correspondingData.warnings.some(w => w.type === 'prefix')) lineDiv.classList.add('warning-prefix');
                    if (correspondingData.warnings.some(w => w.type === 'typo')) lineDiv.classList.add('warning-typo');
                }
                outputDiv.appendChild(lineDiv);
            });

            updateStats(dataArray.length, type);
            updateDomainStats(processedData);
            updateWarningBox(processedData);
            
            const btn = document.getElementById('batchCopyBtn');
            btn.style.display = dataArray.length > 50 ? 'inline-block' : 'none';
            if (dataArray.length > 50) {
                currentBatchIndex = 0;
                btn.textContent = `ğŸ“‹ 1-${Math.min(50, dataArray.length)}ä»¶ã‚’ã‚³ãƒ”ãƒ¼`;
            }
        }

        function updateWarningBox(data) {
            const warningBox = document.getElementById('warningBox');
            const warnings = { domain: 0, prefix: 0, typo: [] };
            data.forEach(d => {
                d.warnings.forEach(w => {
                    if(w.type === 'typo') warnings.typo.push({original: d.originalEmail, suggestion: w.suggestion});
                    else warnings[w.type]++;
                });
            });

            if (warnings.domain > 0 || warnings.prefix > 0 || warnings.typo.length > 0) {
                let message = 'âš ï¸ ä»¥ä¸‹ã®å¯èƒ½æ€§ãŒã‚ã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ:<ul>';
                if (warnings.domain > 0) message += `<li><span class="output-line warning-domain">ã‚¹ãƒ‘ãƒ ãƒ»ä½¿ã„æ¨ã¦ã®å¯èƒ½æ€§ãŒã‚ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³:</span> ${warnings.domain}ä»¶</li>`;
                if (warnings.prefix > 0) message += `<li><span class="output-line warning-prefix">ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ‰ãƒ¬ã‚¹ (è¿”ä¿¡ä¸å¯ã®å¯èƒ½æ€§):</span> ${warnings.prefix}ä»¶</li>`;
                warnings.typo.forEach(t => {
                    message += `<li><span class="output-line warning-typo">ã‚¿ã‚¤ãƒ—ãƒŸã‚¹ã®å¯èƒ½æ€§:</span> ${t.original} â†’ ${t.suggestion} <button class="btn-secondary typo-fix-btn" data-original="${t.original}" data-suggestion="${t.suggestion}">ä¿®æ­£</button></li>`;
                });
                message += '</ul>';
                warningBox.innerHTML = message;
                warningBox.style.display = 'block';
            } else {
                warningBox.style.display = 'none';
            }
        }
        
        function updateStats(count, type) { document.getElementById('stats').innerHTML = `<div class="stat-item"><strong>ä»¶æ•°:</strong> ${count} ${type}</div> <div class="stat-item"><strong>å‡¦ç†æ—¥æ™‚:</strong> ${new Date().toLocaleTimeString()}</div>`; }
        function updateDomainStats(data) {
            const domainCounts = data.reduce((acc, item) => { const domain = item.email.split('@')[1]; if (domain) { acc[domain] = (acc[domain] || 0) + 1; } return acc; }, {});
            const sortedDomains = Object.entries(domainCounts).sort(([,a],[,b]) => b-a);
            const tableContainer = document.getElementById('domainTableContainer');
            tableContainer.innerHTML = sortedDomains.length > 0 ? '<h4>ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ¥é›†è¨ˆ</h4><table><tr><th>ãƒ‰ãƒ¡ã‚¤ãƒ³</th><th>ä»¶æ•°</th><th>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th></tr>' + sortedDomains.map(([d, c]) => `<tr><td>${d}</td><td>${c}</td><td><button class="btn-domain-copy" data-domain="${d}">ã‚³ãƒ”ãƒ¼</button></td></tr>`).join('') + '</table>' : '';
            
            const chartCanvas = document.getElementById('domainChart');
            if (domainChartInstance) domainChartInstance.destroy();
            if (sortedDomains.length > 0) {
                chartCanvas.style.display = 'block';
                const labels = sortedDomains.map(item => item[0]);
                const counts = sortedDomains.map(item => item[1]);
                domainChartInstance = new Chart(chartCanvas, { type: 'pie', data: { labels, datasets: [{ data: counts, backgroundColor: ['#007bff', '#28a745', '#ffc107', '#dc3545', '#17a2b8', '#6c757d', '#fd7e14', '#6610f2', '#20c997'] }] }, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: labels.length <= 8, position: 'right' } } } });
            } else { chartCanvas.style.display = 'none'; }
        }

        // --- ãƒ¬ã‚·ãƒ”æ©Ÿèƒ½ ---
        function runAndRecord(funcName, ...args) {
            if (isRecording) currentRecipe.push([funcName, ...args]);
            const func = window[funcName];
            if (typeof func === 'function') func(...args);
        }

        function toggleRecording() {
            isRecording = !isRecording;
            const btn = document.getElementById('recordBtn');
            if (isRecording) {
                currentRecipe = [];
                btn.textContent = 'â¹ï¸ è¨˜éŒ²åœæ­¢';
                btn.classList.replace('btn-info', 'btn-danger');
            } else {
                btn.textContent = 'âºï¸ è¨˜éŒ²é–‹å§‹';
                btn.classList.replace('btn-danger', 'btn-info');
            }
        }

        function saveRecipe() {
            if (currentRecipe.length === 0) { alert('ä¿å­˜ã™ã‚‹æ“ä½œãŒã‚ã‚Šã¾ã›ã‚“ã€‚è¨˜éŒ²ã‚’é–‹å§‹ã—ã¦æ“ä½œã‚’è¡Œã£ã¦ãã ã•ã„ã€‚'); return; }
            const name = prompt('ã“ã®ãƒ¬ã‚·ãƒ”ã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:', `ãƒ¬ã‚·ãƒ” ${new Date().toLocaleString()}`);
            if (name) {
                const recipes = JSON.parse(localStorage.getItem('yutools-mail-wizard-recipes') || '{}');
                recipes[name] = currentRecipe;
                localStorage.setItem('yutools-mail-wizard-recipes', JSON.stringify(recipes));
                loadRecipes();
                if(isRecording) toggleRecording();
            }
        }
        
        function loadRecipes() {
            const recipes = JSON.parse(localStorage.getItem('yutools-mail-wizard-recipes') || '{}');
            const select = document.getElementById('recipeList');
            select.innerHTML = '';
            for (const name in recipes) {
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                select.appendChild(option);
            }
        }

        async function runRecipe() {
            const select = document.getElementById('recipeList');
            const name = select.value;
            if (!name) { alert('å®Ÿè¡Œã™ã‚‹ãƒ¬ã‚·ãƒ”ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚'); return; }
            const recipes = JSON.parse(localStorage.getItem('yutools-mail-wizard-recipes') || '{}');
            const recipe = recipes[name];
            if (recipe) {
                for (const step of recipe) {
                    const [funcName, ...args] = step;
                    const func = window[funcName];
                    if (typeof func === 'function') {
                        func(...args);
                        await new Promise(resolve => setTimeout(resolve, 50)); // å‡¦ç†ã®é–“ã«ã‚ãšã‹ãªå¾…æ©Ÿæ™‚é–“
                    }
                }
            }
        }

        function deleteRecipe() {
            const select = document.getElementById('recipeList');
            const name = select.value;
            if (!name || !confirm(`ã€Œ${name}ã€ã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ`)) return;
            const recipes = JSON.parse(localStorage.getItem('yutools-mail-wizard-recipes') || '{}');
            delete recipes[name];
            localStorage.setItem('yutools-mail-wizard-recipes', JSON.stringify(recipes));
            loadRecipes();
        }
        
        // --- ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ & è£œæ­£æ©Ÿèƒ½ ---
        function copyToClipboard(button, text) { if (!text) return; navigator.clipboard.writeText(text).then(() => { const o = button.textContent; button.textContent = 'âœ…'; if (!button.classList.contains('btn-domain-copy')) { button.style.backgroundColor = 'var(--success-color)'; button.style.borderColor = 'var(--success-color)'; } setTimeout(() => { button.textContent = o; if (!button.classList.contains('btn-domain-copy')) { button.style.backgroundColor = ''; button.style.borderColor = ''; } }, 1500); }); }
        function copyDomainEmails(domain, button) { const emails = processedData.filter(item => item.email.endsWith('@' + domain)).map(item => item.email); if (emails.length > 0) copyToClipboard(button, emails.join('\n')); }
        function copyBatch() { const lines = document.getElementById('outputText').textContent.split('\n'); if (lines.length === 0) return; const batchSize = 50; const start = currentBatchIndex * batchSize; const batch = lines.slice(start, start + batchSize); if (batch.length > 0) { copyToClipboard(document.getElementById('batchCopyBtn'), batch.join('\n')); currentBatchIndex = (start + batchSize >= lines.length) ? 0 : currentBatchIndex + 1; const nextStart = currentBatchIndex * batchSize; document.getElementById('batchCopyBtn').textContent = `ğŸ“‹ ${nextStart + 1}-${Math.min(nextStart + batchSize, lines.length)}ä»¶ã‚’ã‚³ãƒ”ãƒ¼`; } }
        function downloadFile(content, fileName, mimeType) { if (!content) return; const blob = new Blob([content], { type: `${mimeType};charset=utf-8` }); const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = fileName; document.body.appendChild(a); a.click(); document.body.removeChild(a); URL.revokeObjectURL(a.href); }
        function downloadAsCsv() {
            if(processedData.length === 0) return;
            let csvContent = '"name","email","lastName","firstName"\n';
            processedData.forEach(item => {
                const name = item.hasExplicitName ? item.name : '';
                const lastName = item.hasExplicitName ? item.lastName : '';
                const firstName = item.hasExplicitName ? item.firstName : '';
                csvContent += `"${name}","${item.email}","${lastName}","${firstName}"\n`;
            });
            downloadFile(csvContent, 'email-list.csv', 'text/csv');
        }
        function downloadAsJson() { if(processedData.length === 0) return; downloadFile(JSON.stringify(processedData, null, 2), 'application/json'); }
        function swapInputOutput() { const outputText = document.getElementById('outputText').textContent; document.getElementById('inputText').value = outputText; document.getElementById('inputText').dispatchEvent(new Event('input')); clearResultArea(); }
        function clearInput() { document.getElementById('inputText').value = ''; localStorage.removeItem('yutools-mail-wizard-savedInput'); clearResultArea(); }
        function clearResultArea() { document.getElementById('outputText').innerHTML = ''; document.getElementById('stats').innerHTML = ''; updateDomainStats([]); document.getElementById('batchCopyBtn').style.display = 'none'; document.getElementById('warningBox').style.display = 'none'; processedData = [];}
        function toggleAdvanced() { document.getElementById('advancedOptions').classList.toggle('show'); }
        function loadSampleData() { document.getElementById('inputText').value = `"ç”°ä¸­ å¤ªéƒ" <tanaka@example.com>, ã•ã¨ã† ã¯ãªã“ <sato@example.com>; å±±ç”° æ¬¡éƒ <yamada.jiro@example.co.jp>\nJohn Smith <john.smith@example.com>\nã™ãšã ã„ã¡ã‚ã† <suzuki@gmail.com>\nwatanabe@example.co.jp, "ãŸãªã‹ ã¿ã•ã" <tanaka.misaki@example.com>\ntanaka@example.com\ninvalid-email-format\n"Sato Hanako" <sato.hanako@gmail.com>\ntakahashi@yahoo.co.jp`; document.getElementById('inputText').dispatchEvent(new Event('input')); }

        function applyToOutput(transformation) {
            const outputDiv = document.getElementById('outputText');
            if(!outputDiv.hasChildNodes()) return;
            outputDiv.querySelectorAll('.output-line').forEach(lineDiv => { lineDiv.textContent = transformation(lineDiv.textContent); });
        }

        function unifyEmailCase(type) {
            if(processedData.length === 0) return;
            processedData.forEach(item => {
                if (type === 'lowercase_all') item.email = item.email.toLowerCase();
            });
            const outputDiv = document.getElementById('outputText');
            outputDiv.querySelectorAll('.output-line').forEach(lineDiv => {
                const mailMatch = lineDiv.textContent.match(/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/);
                if (mailMatch) {
                    lineDiv.textContent = lineDiv.textContent.replace(mailMatch[0], mailMatch[0].toLowerCase());
                }
            });
            updateDomainStats(processedData);
        }
        
        function convertToLowercase() { applyToOutput(line => line.toLowerCase()); }
        function convertToHtmlLink() { applyToOutput(line => line.trim() ? `<a href="mailto:${line.trim()}">${line.trim()}</a>` : ''); }
        function convertSeparators() {
            const outputDiv = document.getElementById('outputText');
            if (!outputDiv.hasChildNodes()) return;
            const getRealSeparator = val => ({'\\n': '\n', '\\t': '\t'})[val] || val;
            const from = getRealSeparator(document.getElementById('fromSeparator').value);
            const to = getRealSeparator(document.getElementById('toSeparator').value);
            if (from === to) return;
            const textContent = Array.from(outputDiv.querySelectorAll('.output-line')).map(div => div.textContent).join(from);
            const items = textContent.split(from).filter(item => item.trim() !== '');
            outputDiv.innerHTML = '';
            if (to === '\n') {
                items.forEach(item => { const d = document.createElement('div'); d.className='output-line'; d.textContent=item.trim(); outputDiv.appendChild(d); });
            } else {
                const d = document.createElement('div'); d.className='output-line'; d.textContent=items.join(to); outputDiv.appendChild(d);
            }
        }
        function capitalizeNames() { applyToOutput(line => line.toLowerCase().split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ')); }
        function removeSpaces() { applyToOutput(line => line.replace(/[\sã€€]+/g, '')); }
        function convertToFullWidthKana() {
            const kanaMap = { 'ï½¶ï¾':'ã‚¬','ï½·ï¾':'ã‚®','ï½¸ï¾':'ã‚°','ï½¹ï¾':'ã‚²','ï½ºï¾':'ã‚´','ï½»ï¾':'ã‚¶','ï½¼ï¾':'ã‚¸','ï½½ï¾':'ã‚º','ï½¾ï¾':'ã‚¼','ï½¿ï¾':'ã‚¾','ï¾€ï¾':'ãƒ€','ï¾ï¾':'ãƒ‚','ï¾‚ï¾':'ãƒ…','ï¾ƒï¾':'ãƒ‡','ï¾„ï¾':'ãƒ‰','ï¾Šï¾':'ãƒ','ï¾‹ï¾':'ãƒ“','ï¾Œï¾':'ãƒ–','ï¾ï¾':'ãƒ™','ï¾ï¾':'ãƒœ','ï¾Šï¾Ÿ':'ãƒ‘','ï¾‹ï¾Ÿ':'ãƒ”','ï¾Œï¾Ÿ':'ãƒ—','ï¾ï¾Ÿ':'ãƒš','ï¾ï¾Ÿ':'ãƒ','ï½³ï¾':'ãƒ´','ï¾œï¾':'ãƒ·','ï½¦ï¾':'ãƒº','ï½±':'ã‚¢','ï½²':'ã‚¤','ï½³':'ã‚¦','ï½´':'ã‚¨','ï½µ':'ã‚ª','ï½¶':'ã‚«','ï½·':'ã‚­','ï½¸':'ã‚¯','ï½¹':'ã‚±','ï½º':'ã‚³','ï½»':'ã‚µ','ï½¼':'ã‚·','ï½½':'ã‚¹','ï½¾':'ã‚»','ï½¿':'ã‚½','ï¾€':'ã‚¿','ï¾':'ãƒ','ï¾‚':'ãƒ„','ï¾ƒ':'ãƒ†','ï¾„':'ãƒˆ','ï¾…':'ãƒŠ','ï¾†':'ãƒ‹','ï¾‡':'ãƒŒ','ï¾ˆ':'ãƒ','ï¾‰':'ãƒ','ï¾Š':'ãƒ','ï¾‹':'ãƒ’','ï¾Œ':'ãƒ•','ï¾':'ãƒ˜','ï¾':'ãƒ›','ï¾':'ãƒ','ï¾':'ãƒŸ','ï¾‘':'ãƒ ','ï¾’':'ãƒ¡','ï¾“':'ãƒ¢','ï¾”':'ãƒ¤','ï¾•':'ãƒ¦','ï¾–':'ãƒ¨','ï¾—':'ãƒ©','ï¾˜':'ãƒª','ï¾™':'ãƒ«','ï¾š':'ãƒ¬','ï¾›':'ãƒ­','ï¾œ':'ãƒ¯','ï½¦':'ãƒ²','ï¾':'ãƒ³','ï½§':'ã‚¡','ï½¨':'ã‚£','ï½©':'ã‚¥','ï½ª':'ã‚§','ï½«':'ã‚©','ï½¯':'ãƒƒ','ï½¬':'ãƒ£','ï½­':'ãƒ¥','ï½®':'ãƒ§','ï½¡':'ã€‚','ï½¤':'ã€','ï½°':'ãƒ¼','ï½¢':'ã€Œ','ï½£':'ã€','ï½¥':'ãƒ»' };
            applyToOutput(line => line.replace(new RegExp('(' + Object.keys(kanaMap).join('|') + ')', 'g'), m => kanaMap[m]));
        }
        function convertToHalfWidthAlpha() { applyToOutput(line => line.replace(/[ï¼¡-ï¼ºï½-ï½šï¼-ï¼™]/g, s => String.fromCharCode(s.charCodeAt(0) - 0xFEE0))); }
    </script>
    <div id="footer-placeholder"></div>
   <script src="/js/common.js" defer></script>
</body>
</html>